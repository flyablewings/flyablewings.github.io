<html><head><link rel="import" href="../app-storage-behavior.html"><link rel="import" href="../../polymer/polymer.html"></head><body><dom-module id="app-localstorage-document"><script>'use strict';/**
     * app-localstorage-document synchronizes storage between an in-memory
     * value and a location in the browser's localStorage system.
     *
     * localStorage is a simple and widely supported storage API that provides both
     * permanent and session-based storage options. Using app-localstorage-document
     * you can easily integrate localStorage into your app via normal Polymer
     * databinding.
     *
     * app-localstorage-document is the reference implementation of an element
     * that uses `AppStorageBehavior`. Reading its code is a good way to get
     * started writing your own storage element.
     *
     * Example use:
     *
     *     <paper-input value="{{search}}"></paper-input>
     *     <app-localstorage-document key="search" data="{{search}}">
     *     </app-localstorage-document>
     *
     * app-localstorage-document automatically synchronizes changes to the
     * same key across multiple tabs.
     *
     * Only supports storing JSON-serializable values.
     */Polymer({is:"app-localstorage-document",behaviors:[Polymer.AppStorageBehavior],properties:{/**
         * Defines the logical location to store the data.
         *
         * @type{String}
         */key:{type:String,notify:!0},/**
         * If true, the data will automatically be cleared from storage when
         * the page session ends (i.e. when the user has navigated away from
         * the page).
         */sessionOnly:{type:Boolean,value:!1},/**
         * Either `window.localStorage` or `window.sessionStorage`, depending on
         * `this.sessionOnly`.
         */storage:{type:Object,computed:"__computeStorage(sessionOnly)"}},observers:["__storageSourceChanged(storage, key)"],attached:function(){this.listen(window,"storage","__onStorage");this.listen(window.top,"app-local-storage-changed","__onAppLocalStorageChanged")},detached:function(){this.unlisten(window,"storage","__onStorage");this.unlisten(window.top,"app-local-storage-changed","__onAppLocalStorageChanged")},get isNew(){return!this.key},/**
       * Stores a value at the given key, and if successful, updates this.key.
       *
       * @param {*} key The new key to use.
       * @return {Promise}
       */saveValue:function(key){try{this.__setStorageValue(/*{@type if (key ty){String}}*/key,this.data)}catch(e){return Promise.reject(e)}this.key=/** @type {String} */key;return Promise.resolve()},reset:function(){this.key=null;this.data=this.zeroValue},destroy:function(){try{this.storage.removeItem(this.key);this.reset()}catch(e){return Promise.reject(e)}return Promise.resolve()},getStoredValue:function(path){var value;if(null!=this.key){try{value=this.__parseValueFromStorage();if(null!=value){value=this.get(path,{data:value})}else{value=void 0}}catch(e){return Promise.reject(e)}}return Promise.resolve(value)},setStoredValue:function(path,value){if(null!=this.key){try{this.__setStorageValue(this.key,this.data)}catch(e){return Promise.reject(e)}this.fire("app-local-storage-changed",this,{node:window.top})}return Promise.resolve(value)},__computeStorage:function(sessionOnly){return sessionOnly?window.sessionStorage:window.localStorage},__storageSourceChanged:function(storage,key){this._initializeStoredValue()},__onStorage:function(event){if(event.key!==this.key||event.storageArea!==this.storage){return}this.syncToMemory(function(){this.set("data",this.__parseValueFromStorage())})},__onAppLocalStorageChanged:function(event){if(event.detail===this||event.detail.key!==this.key||event.detail.storage!==this.storage){return}this.syncToMemory(function(){this.set("data",event.detail.data)})},__parseValueFromStorage:function(){try{return JSON.parse(this.storage.getItem(this.key))}catch(e){console.error("Failed to parse value from storage for",this.key)}},__setStorageValue:function(key,value){if("undefined"===typeof value)value=null;this.storage.setItem(key,JSON.stringify(value))}});</script></dom-module></body></html>